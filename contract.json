{
  "swagger": "2.0",
  "info": {
    "description": "This is the REST API that creates a relation between the mobile app and the front of your door.",
    "version": "Z",
    "title": "Leave Me Alone"
  },
  "host": "localhost:3000/leavemealone",
  "tags": [
    {
      "name": "user",
      "description": "Everything about users."
    },
    {
      "name": "house",
      "description": "Everything about house."
    }
  ],
  "paths": {
    "/user/register": {
      "post": {
        "tags": [
          "user"
        ],
        "summary": "Creates a new user.",
        "description": "Register a new user and retrieves a JWT token to work with API.",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "User object that needs to be created and house's digital key.",
            "required": true,
            "schema": {
              "$ref": "#/definitions/registerBody"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "User has been created",
            "schema": {
              "$ref": "#/definitions/loginResponse"
            }
          },
          "400": {
            "description": "Missing property in the body"
          },
          "403": {
            "description": "Username or email already exists"
          }
        }
      }
    },
    "/user/login": {
      "post": {
        "tags": [
          "user"
        ],
        "summary": "Login the user.",
        "description": "To retrieve the user informations and a JWT token to work with API.",
        "consumes": [
          "application/json"
        ],
        "produces": [
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "description": "Email or username and password to authenticate.",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "emailOrUserName": {
                  "type": "string",
                  "example": "Alex"
                },
                "password": {
                  "type": "string",
                  "example": "zzz"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "User has been logged in.",
            "schema": {
              "$ref": "#/definitions/loginResponse"
            }
          },
          "403": {
            "description": "Incorrect password."
          },
          "404": {
            "description": "This email or username doesn't exists."
          }
        }
      }
    },
    "/house/sensors": {
      "get": {
        "tags": [
          "house"
        ],
        "summary": "Retrieves the status of the house sensors.",
        "responses": {
          "200": {
            "description": "Here you have the status of the sensors.",
            "schema": {
              "$ref": "#/definitions/loginResponse"
            }
          },
          "404": {
            "description": "The user doesn't have any house."
          },
          "401": {
            "description": "Unauthorized or invalid access token."
          }
        },
        "security": [
          {
            "Bearer": []
          }
        ]
      }
    },
    "/house/sensors/spotlight/toggle": {
      "put": {
        "tags": [
          "house"
        ],
        "summary": "Toggles the spotlight.",
        "responses": {
          "200": {
            "description": "The spotlight has been toggled."
          },
          "401": {
            "description": "Unauthorized or invalid access token."
          }
        },
        "security": [
          {
            "Bearer": []
          }
        ]
      }
    },
    "/house/sensors/alarm/toggle": {
      "put": {
        "tags": [
          "house"
        ],
        "summary": "Toggles the alarm.",
        "responses": {
          "200": {
            "description": "The alarm has been toggled."
          },
          "401": {
            "description": "Unauthorized or invalid access token."
          }
        },
        "security": [
          {
            "Bearer": []
          }
        ]
      }
    }
  },
  "securityDefinitions": {
    "Bearer": {
      "type": "apiKey",
      "name": "Authorization",
      "in": "header"
    }
  },
  "definitions": {
    "User": {
      "type": "object",
      "properties": {
        "userName": {
          "type": "string",
          "example": "Alex"
        },
        "firstName": {
          "type": "string",
          "example": "Alexandre"
        },
        "lastName": {
          "type": "string",
          "example": "Viale"
        },
        "email": {
          "type": "string",
          "example": "alexandre.viale@leavemealone.com"
        },
        "password": {
          "type": "string",
          "example": "zzz"
        }
      }
    },
    "Sensors": {
      "type": "object",
      "properties": {
        "userName": {
          "type": "string",
          "example": "Alex"
        },
        "firstName": {
          "type": "string",
          "example": "Alexandre"
        },
        "lastName": {
          "type": "string",
          "example": "Viale"
        },
        "email": {
          "type": "string",
          "example": "alexandre.viale@leavemealone.com"
        },
        "password": {
          "type": "string",
          "example": "zzz"
        }
      }
    },
    "loginResponse": {
      "type": "object",
      "properties": {
        "user": {
          "type": "object",
          "properties": {
            "userName": {
              "type": "string",
              "example": "Alex"
            },
            "firstName": {
              "type": "string",
              "example": "Alexandre"
            },
            "lastName": {
              "type": "string",
              "example": "Viale"
            },
            "email": {
              "type": "string",
              "example": "alexandre.viale@leavemealone.com"
            }
          }
        },
        "accessToken": {
          "type": "string",
          "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyIjp7Imxhc3ROYW1lIjoiZmV6ZnphZWZ6YSIsImZpcnN0TmFtZSI6ImZhemZheiIsImVtYWlsIjoiZmV6ZmVhekBkYXpkYS5mciIsInVzZXJOYW1lIjoidGVzdHpmZXpmZXp6eiIsIl9pZCI6IjYyM2E1NDhjZDAxOTMyMjdlMjFhNWYwYiIsIl9fdiI6MH0sImlhdCI6MTY0Nzk4OTkwMCwiZXhwIjoxNjc5NTQ3NTAwfQ.6_RhXetPSh-Nga_b_b2Pp_Tolu_33C7OrtJpSquVg8s"
        }
      }
    },
    "registerBody": {
      "type": "object",
      "properties": {
        "userName": {
          "type": "string",
          "example": "Alex"
        },
        "firstName": {
          "type": "string",
          "example": "Alexandre"
        },
        "lastName": {
          "type": "string",
          "example": "Viale"
        },
        "email": {
          "type": "string",
          "example": "alexandre.viale@leavemealone.com"
        },
        "password": {
          "type": "string",
          "example": "zzz"
        },
        "digitalKey": {
          "type": "string",
          "example": "dzkeauygbfykzhukejkfbezj"
        }
      }
    }
  }
}